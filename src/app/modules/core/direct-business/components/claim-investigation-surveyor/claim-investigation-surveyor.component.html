<div class="container">
  <div class="form-wrapper">

    <!-- heading section -->
    <div class="heading-section ng-star-inserted">
      <div>Claim Investigation Surveyor</div>
      <div class="font-heading"><strong>Reference Number:</strong> 19-20/DOI/DB/CIS/001</div>
      <div class="font-heading"><strong>Reference Date:</strong> {{ todayDate | date: 'dd-MMM-yyyy HH:mm'}}
      </div>
    </div>

    <!-- navigation start -->
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="#">Home</a></li>
        <li class="breadcrumb-item " aria-current="page">DOI / DB </li>
        <li class="breadcrumb-item active" aria-current="page">Claim Investigation Surveyor</li>
      </ol>
    </nav>
    <!-- navigation ends -->



    <div class="panel-group">
      <mat-tab-group mat-stretch-tabs [selectedIndex]="selectedIndex" (selectedIndexChange)="getTabIndex($event)">

        <mat-tab label="Claim Entry">
          <!-- Claim Entry  Form-->
          <form [formGroup]="claimInvestigationSurveyorForm">

            <!-- Claim Entry -->
            <div class="box box-primary">
              <div class="box-header">Claim Entry</div>
              <div class="box-body">

                <div class="row">

                  <!-- Insured name -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <mat-select formControlName="insuredName" placeholder="Insured Name" required>
                        <mat-option>
                          <ngx-mat-select-search [formControl]="insuredNameCtrl"
                            [placeholderLabel]="'Find Insured Name...'"
                            [noEntriesFoundLabel]="'No matching Insured Name found'">
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let item of insuredNameList | filterSelectInput:insuredNameCtrl.value"
                          [value]="item.value" matTooltip="{{item.viewValue}}">
                          {{item.viewValue}}
                        </mat-option>
                      </mat-select>
                      <div class="error-wrapper"
                        *ngIf="claimInvestigationSurveyorForm.controls.insuredName.touched && claimInvestigationSurveyorForm.controls.insuredName.errors">
                        <mat-error *ngIf="claimInvestigationSurveyorForm.controls.insuredName.errors.required">
                          {{ errorMessage.INSURED_NAME_SELECT }}
                        </mat-error>
                      </div>
                    </mat-form-field>
                  </div>

                  <!-- Policy No -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <mat-select formControlName="policyNo" placeholder="Policy No."
                        (selectionChange)="selectPolicyNo($event)" required>
                        <mat-option>
                          <ngx-mat-select-search [formControl]="policyNoCtrl" [placeholderLabel]="'Find Policy No....'"
                            [noEntriesFoundLabel]="'No matching Policy No. found'">
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let item of policyNoList |
                          filterSelectInput:policyNoCtrl.value" [value]="item.value" matTooltip="{{item.viewValue}}">
                          {{item.viewValue}}
                        </mat-option>
                      </mat-select>
                      <div class="error-wrapper"
                        *ngIf="claimInvestigationSurveyorForm.controls.policyNo.touched && claimInvestigationSurveyorForm.controls.policyNo.errors">
                        <mat-error *ngIf="claimInvestigationSurveyorForm.controls.policyNo.errors.required">
                          {{ errorMessage.POLICY_NO_SELECT }}
                        </mat-error>
                      </div>

                    </mat-form-field>
                  </div>


                  <!-- policy start date -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput [matDatepicker]="policyStartDate" formControlName="startDate"
                        placeholder="Policy Start Date">
                      <mat-datepicker-toggle matSuffix [for]="policyStartDate"></mat-datepicker-toggle>
                      <mat-datepicker #policyStartDate></mat-datepicker>
                    </mat-form-field>
                  </div>


                  <!-- policy end date -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput [matDatepicker]="policyEndDate" formControlName="endDate"
                        placeholder="Policy End Date">
                      <mat-datepicker-toggle matSuffix [for]="policyEndDate"></mat-datepicker-toggle>
                      <mat-datepicker #policyEndDate></mat-datepicker>
                    </mat-form-field>
                  </div>


                  <!-- address -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="address" placeholder="Address">
                    </mat-form-field>
                  </div>

                  <!-- district -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="district" placeholder="District">
                    </mat-form-field>
                  </div>

                  <!-- taluka -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="taluka" placeholder="Taluka">
                    </mat-form-field>
                  </div>

                  <!-- contact no -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="contactNo" placeholder="Contact No." numbersOnly maxlength="12">
                    </mat-form-field>
                  </div>

                  <!-- email id -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <input matInput type="text" placeholder="Email ID" formControlName="email">
                    </mat-form-field>
                  </div>

                </div>
              </div>
            </div>
            <!-- Claim Entry End -->

            <!-- Policy Details -->
            <div class="box box-primary">
              <div class="box-header">Policy Details</div>
              <div class="box-body">

                <div class="row">

                  <!-- Claim Type -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <input matInput type="text" placeholder="Claim Type" formControlName="claimType">
                    </mat-form-field>
                  </div>

                  <!-- Sum Insured -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="sumInsured" placeholder="Sum Insured" numbersOnly>
                    </mat-form-field>
                  </div>

                  <!-- Claim Amount -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="claimAmount" placeholder="Claim Amount" numbersOnly>
                    </mat-form-field>
                  </div>

                </div>

              </div>
            </div>
            <!-- Policy Details End-->

            <!-- Details of loss/ damage -->
            <div class="box box-primary">
              <div class="box-header">Details of Loss/ Damage</div>
              <div class="box-body">
                <div class="row">

                  <!-- loss/damage date -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput [matDatepicker]="lossDamageDate" formControlName="lossDamageDate"
                        placeholder="Date of Loss/ Damage" [max]="todayDate">
                      <mat-datepicker-toggle matSuffix [for]="lossDamageDate"></mat-datepicker-toggle>
                      <mat-datepicker #lossDamageDate></mat-datepicker>
                    </mat-form-field>
                  </div>

                  <!-- time -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="time" placeholder="Time (HH:MM)" maxlength="8">
                    </mat-form-field>
                  </div>

                  <!-- cause of loss/ damage -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="lossDamageCause" placeholder="Cause of Loss/ Damage">
                    </mat-form-field>
                  </div>

                  <!-- cause of loss/ damage -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="lossExtend" placeholder="Extend of loss/damage">
                    </mat-form-field>
                  </div>

                  <!-- surveyor remarks -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="surveyorRemarks" placeholder="Surveyor Remarks">
                    </mat-form-field>
                  </div>

                </div>

              </div>
            </div>
            <!-- Details of loss/ damage end -->

          </form>
          <!-- Claim Entry Form End-->


          <!-- Details of property/asset -->
          <div class="box box-primary">
            <div class="box-header">Details of Property/ Asset</div>
            <div class="box-body">
              <div class="row">

                <div class="col-sm-12">
                  <div class="mat-elevation-z8 mt-2">
                    <!-- table start -->
                    <table mat-table [dataSource]="dataSource" matSort aria-describedby="detailsOfPropertyAsset">

                      <!-- serial No -->
                      <ng-container matColumnDef="position">
                        <th mat-header-cell *matHeaderCellDef scope="row">Sr. No.</th>
                        <td mat-cell *matCellDef="let element;let i= index" class="centerAlign">
                          {{i+1}}
                        </td>
                        <td mat-footer-cell *matFooterCellDef>Total</td>
                      </ng-container>

                      <!-- description of item -->
                      <ng-container matColumnDef="itemDescription">
                        <th mat-header-cell *matHeaderCellDef scope="row">Description of Item *</th>
                        <td mat-cell *matCellDef="let element">
                          {{element.itemDescription}}
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                      </ng-container>

                      <!-- item serial no -->
                      <ng-container matColumnDef="serialNo">
                        <th mat-header-cell *matHeaderCellDef scope="row">Item Serial No. *</th>
                        <td mat-cell *matCellDef="let element">
                          {{element.serialNo}}
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                      </ng-container>

                      <!-- actual value -->
                      <ng-container matColumnDef="actualValue">
                        <th mat-header-cell *matHeaderCellDef scope="row">Actual Value *</th>
                        <td mat-cell *matCellDef="let element" class="rightAlign">
                          {{element.actualValue  | number:'1.2-2'}}
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                      </ng-container>

                      <!-- value at the time of loss -->
                      <ng-container matColumnDef="valueAtLossTime">
                        <th mat-header-cell *matHeaderCellDef scope="row">Value at the time of loss *</th>
                        <td mat-cell *matCellDef="let element" class="rightAlign">
                          {{element.valueAtLossTime  | number:'1.2-2'}}
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                      </ng-container>


                      <!-- amount claim -->
                      <ng-container matColumnDef="amountClaim">
                        <th mat-header-cell *matHeaderCellDef scope="row">Amount Claim *</th>
                        <td mat-cell *matCellDef="let element" class="rightAlign">
                          {{element.amountClaim | number:'1.2-2'}}
                        </td>
                        <td mat-footer-cell *matFooterCellDef class="rightAlign">
                          {{calculateClaimAmount() | number:'1.2-2'}}</td>
                      </ng-container>

                      <!-- surveyor remarks -->
                      <ng-container matColumnDef="surveyorRemarks">
                        <th mat-header-cell *matHeaderCellDef scope="row">Surveyor Remarks *</th>
                        <td mat-cell *matCellDef="let element">
                          <mat-form-field class="example-full-width">
                            <input matInput [(ngModel)]="element.surveyorRemarks" value="{{element.surveyorRemarks}}"
                              [ngModelOptions]="{standalone: true}">
                          </mat-form-field>
                        </td>
                        <td mat-footer-cell *matFooterCellDef></td>
                      </ng-container>



                      <!-- Header Section Of table -->
                      <tr mat-header-row *matHeaderRowDef="columns"></tr>
                      <!-- Data Fetch From .TS File to table -->
                      <tr mat-row *matRowDef="let row; let i = index;columns:columns"></tr>
                      <!-- Footer Section Of table -->
                      <tr mat-footer-row *matFooterRowDef="columns"></tr>

                    </table>
                    <!-- table end -->

                    <!-- paginator -->
                    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <!-- Details of Previous Loss -->
          <div class="box box-primary">
            <div class="box-header">Details of Previous Loss</div>
            <div class="box-body">
              <div class="row">

                <div class="col-sm-12">
                  <div class="mat-elevation-z8 mt-2">
                    <!-- table start -->
                    <table mat-table [dataSource]="dataSourceLoss" matSort aria-describedby="detailsOfPreviousLoss">

                      <!-- serial No -->
                      <ng-container matColumnDef="position">
                        <th mat-header-cell *matHeaderCellDef scope="row">Sr. No.</th>
                        <td mat-cell *matCellDef="let element;let i= index" class="centerAlign">
                          {{i+1}}
                        </td>
                      </ng-container>

                      <!-- claim year -->
                      <ng-container matColumnDef="claimYear">
                        <th mat-header-cell *matHeaderCellDef scope="row">Claim Year</th>
                        <td mat-cell *matCellDef="let element">
                          {{element.claimYear}}
                        </td>
                      </ng-container>

                      <!-- claim description -->
                      <ng-container matColumnDef="claimDescription">
                        <th mat-header-cell *matHeaderCellDef scope="row">Claim Description</th>
                        <td mat-cell *matCellDef="let element">
                          {{element.claimDescription}}
                        </td>
                      </ng-container>

                      <!-- claim amount -->
                      <ng-container matColumnDef="claimAmount">
                        <th mat-header-cell *matHeaderCellDef scope="row" style="width: 250px;"> Claim Amount
                        </th>
                        <td mat-cell *matCellDef="let element">
                          {{element.claimAmount}}
                        </td>
                      </ng-container>

                      <!-- Header Section Of table -->
                      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                      <!-- Data Fetch From .TS File to table -->
                      <tr mat-row *matRowDef="let row; let i = index;columns:displayedColumns"></tr>

                    </table>
                    <!-- table end -->

                    <!-- paginator -->
                    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
                  </div>
                </div>

              </div>
            </div>
          </div>

          <!-- common action button -->
          <div class="form-action-button">

            <button mat-raised-button type="submit" class="green" title="Submit" (click)="onSubmit()">
              <i class="material-icons">
                done
              </i>
              Submit
            </button>

            <button type="button" mat-raised-button color="accent" title="Reset" (click)="onReset()">
              <i class="material-icons" aria-hidden="true">
                restore
              </i>
              Reset
            </button>

            <button type="button" mat-raised-button (click)="goToListing()" color="warn" title="Listing">
              <i class="material-icons" aria-hidden="true" title="Listing">
                list
              </i>
              Listing
            </button>

            <button type="button" mat-raised-button (click)="onCloseClaimEntry()" class="btnClose" title="Close">
              <i class="material-icons" aria-hidden="true" title="Close">
                close
              </i>
              Close
            </button>

          </div>
          <!-- common action button end -->

        </mat-tab>

        <mat-tab label="Surveyor Details">
          <form [formGroup]="surveyorDetailsForm">

            <!-- Surveyor Details-->
            <div class="box box-primary">
              <div class="box-header">Surveyor Details</div>
              <div class="box-body">

                <div class="row">

                  <!-- surveyor name -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="surveyorName" placeholder="Surveyor Name">
                    </mat-form-field>
                  </div>

                  <!-- address -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="address" placeholder="Address">
                    </mat-form-field>
                  </div>

                  <!-- bill no -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="billNo" placeholder="Bill No" numbersAlphabetsOnly required>
                      <div class="error-wrapper"
                        *ngIf="surveyorDetailsForm.controls.billNo.touched && surveyorDetailsForm.controls.billNo.errors">
                        <mat-error *ngIf="surveyorDetailsForm.controls.billNo.errors.required">
                          {{ errorMessage.BILLNO }}
                        </mat-error>
                      </div>
                    </mat-form-field>
                  </div>

                  <!-- bill date -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput [matDatepicker]="billDate" formControlName="billDate" placeholder="Bill Date"
                        required>
                      <mat-datepicker-toggle matSuffix [for]="billDate"></mat-datepicker-toggle>
                      <mat-datepicker #billDate></mat-datepicker>
                      <div class="error-wrapper"
                        *ngIf="surveyorDetailsForm.controls.billDate.touched && surveyorDetailsForm.controls.billDate.errors">
                        <mat-error *ngIf="surveyorDetailsForm.controls.billDate.errors.required">
                          {{ errorMessage.DATE }}
                        </mat-error>
                      </div>
                    </mat-form-field>
                  </div>

                  <!-- charges -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="charges" placeholder="Charges" numbersOnly required
                        (keypress)="calculateTotalAmount()">
                      <div class="error-wrapper"
                        *ngIf="surveyorDetailsForm.controls.charges.touched && surveyorDetailsForm.controls.charges.errors">
                        <mat-error *ngIf="surveyorDetailsForm.controls.charges.errors.required">
                          {{ errorMessage.CHARGES }}
                        </mat-error>
                      </div>
                    </mat-form-field>
                  </div>

                  <!-- discount -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="discount" placeholder="Discount" numbersOnly>
                    </mat-form-field>
                  </div>

                  <!-- taxes -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="taxes" placeholder="Taxes" numbersOnly>
                    </mat-form-field>
                  </div>

                  <!-- total amount -->
                  <div class="col-sm-3">
                    <mat-form-field>
                      <input matInput formControlName="totalAmount" placeholder="Total Amount" numbersOnly [value]="calculateTotalAmount()">
                    </mat-form-field>
                  </div>

                  <!-- decision -->
                  <div class="col-sm-3">
                    <mat-form-field class="full-width">
                      <mat-select formControlName="decision" placeholder="Decision" required>
                        <mat-option>
                          <ngx-mat-select-search [formControl]="decisionCtrl" [placeholderLabel]="'Find Decision...'"
                            [noEntriesFoundLabel]="'No matching Decision found'">
                          </ngx-mat-select-search>
                        </mat-option>
                        <mat-option *ngFor="let item of decisionList | filterSelectInput:decisionCtrl.value"
                          [value]="item.value" matTooltip="{{item.viewValue}}">
                          {{item.viewValue}}
                        </mat-option>
                      </mat-select>
                      <div class="error-wrapper"
                        *ngIf="surveyorDetailsForm.controls.decision.touched && surveyorDetailsForm.controls.decision.errors">
                        <mat-error *ngIf="surveyorDetailsForm.controls.decision.errors.required">
                          {{ errorMessage.DECISION }}
                        </mat-error>
                      </div>
                    </mat-form-field>
                  </div>


                </div>
              </div>
            </div>

          </form>

          <!-- common action button -->
          <div class="form-action-button">

            <button mat-raised-button type="submit" class="green" title="Submit" (click)="onSubmit()">
              <i class="material-icons">
                done
              </i>
              Submit
            </button>

            <button type="button" mat-raised-button color="accent" title="Reset" (click)="onReset()">
              <i class="material-icons" aria-hidden="true">
                restore
              </i>
              Reset
            </button>

            <button type="button" mat-raised-button (click)="goToListing()" color="warn" title="Listing">
              <i class="material-icons" aria-hidden="true" title="Listing">
                list
              </i>
              Listing
            </button>

            <button type="button" mat-raised-button (click)="onCloseSurveyorDetails()" class="btnClose" title="Close">
              <i class="material-icons" aria-hidden="true" title="Close">
                close
              </i>
              Close
            </button>

          </div>
          <!-- common action button end -->

        </mat-tab>

        <mat-tab label="Attachment">
          <app-common-attachment [attachemntValue]="attachmentTypeCode"></app-common-attachment>

          <!-- action button -->
          <div class="form-action-button">

            <button type="submit" mat-raised-button color="primary">
              <i class="material-icons" aria-hidden="true" title="Upload">
                publish
              </i>
              Upload
            </button>

            <button type="button" mat-raised-button budget-list (click)="goToListing()" color="warn" title="Listing">
              <i class="material-icons" aria-hidden="true" title="Listing">
                list
              </i>
              Listing
            </button>

            <button type="button" mat-raised-button (click)="onClose()" class="btnClose" title="Close">
              <i class="material-icons" aria-hidden="true" title="Close">
                close
              </i>
              Close
            </button>

          </div>
          <!-- action button end -->
        </mat-tab>


      </mat-tab-group>
    </div>
  </div>
</div>